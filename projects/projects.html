<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jason Yap | Projects</title>
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    /* Game/Easter Egg / AI Generator Styles */
    .project-image { cursor: pointer; transition: transform 0.1s ease; }
    .generator-container { margin-top: 1rem; }
    #ai-prompt { width: 70%; padding: 0.5rem; margin-right: 0.5rem; }
    #ai-type, #generate-ai { padding: 0.5rem; }

    @keyframes nuclearExplodePhase1 { 0% { transform: scale(1); opacity: 1; filter: blur(0); } 25% { transform: scale(1.5) rotate(45deg); opacity: 0.8; filter: blur(2px); } 50% { transform: scale(2) rotate(90deg); opacity: 0.5; filter: blur(5px); } 75% { transform: scale(2.5) rotate(135deg); opacity: 0.2; filter: blur(10px); } 100% { transform: scale(3) rotate(180deg); opacity: 0; filter: blur(20px); } }
    @keyframes explosionPulse { 0% { transform: translate(-50%, -50%) scale(0); opacity: 1; } 50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.7; } 100% { transform: translate(-50%, -50%) scale(2); opacity: 0; } }
    @keyframes screenShake { 0%,100%{transform:translateX(0) translateY(0);} 10%,30%,50%,70%,90%{transform:translateX(-10px) translateY(-5px);} 20%,40%,60%,80%{transform:translateX(10px) translateY(5px);} }
    @keyframes matrixFall { 0% { transform: translateY(-20px) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
    @keyframes emergencyFlash { 0%,100%{opacity:0;} 50%{opacity:1;} }
    @keyframes pageSpin { 0%{transform:rotate(0deg) scale(1);}50%{transform:rotate(180deg) scale(1.1);}100%{transform:rotate(360deg) scale(1);} }
    @keyframes emojiFloat { 0%{transform:translate(-50%,-50%) scale(0) rotate(0deg);opacity:1;}50%{transform:translate(-50%,-50%) scale(1.5) rotate(180deg);opacity:0.7;}100%{transform:translate(-50%,-50%) scale(2) rotate(360deg);opacity:0;} }
  </style>
</head>
<body>
  <div id="particles-js"></div>

  <div class="content">
    <header>
      <nav class="main-nav">
        <a href="../index.html">Home</a>
        <a href="../html/resume.html">Resume</a>
        <a href="../projects/projects.html">Projects</a>
        <a href="../recipes/recipes.html">Recipes</a>
      </nav>
    </header>

    <main>
      <!-- slimeScraper Project -->
      <section id="projects">
        <h2>Projects</h2>
        <div class="project about-card">
          <h3>slimeScraper ‚Äì Procedural FPS</h3>
          <img src="../assets/slimeScraper.jpg" alt="slimeScraper Screenshot" class="project-image" />
          <p>A Unity-built roguelike FPS Prototype that generates random office floors each run. Built with C# and Unity in 4 weeks.</p>

          <div class="game-container">
            <h3>üéÆ Play slimeScraper in Browser</h3>
            <div class="game-preview" id="game-preview">
              <div class="game-warning">
                <p>‚ö†Ô∏è <strong>Large File Warning</strong></p>
                <p>This WebGL game is ~25MB and may take time to load.</p>
                <p>Only load if you have a stable internet connection.</p>
                <p>Game has bugs, Sorry in advance if you almost beat the game!</p>
              </div>
              <button class="load-game-btn" onclick="loadGame()">üéÆ Click to Load Game</button>
              <p><small>WebGL Game - Click to load when ready</small></p>
            </div>
            <div class="game-embed" id="game-embed" style="display:none;">
              <iframe frameborder="0" src="about:blank" width="1000" height="800" id="game-iframe" allowfullscreen></iframe>
              <br>
              <button class="unload-game-btn" onclick="unloadGame()">‚ùå Unload Game</button>
            </div>
          </div>

          <div style="margin-top:2rem;">
            <a href="https://drive.google.com/file/d/1kTFxKTB3IJgjsaHWvTi8OBCw61ecxvPT/view?usp=sharing" target="_blank" class="button">‚¨áÔ∏è Download Game (.zip)</a>
            <p class="instructions">After downloading, open the .exe file, extract the ZIP and double-click the `.exe` to play the game. Enjoy the Prototype!</p>
          </div>
        </div>
      </section>

      <hr class="projects-separator">

    <section id="ai-generator" class="project about-card">
        <h2>Multi-Model AI Text Generator</h2>
        <p>Generate AI-powered text responses using OpenAI or DeepSeek models.</p>

        <div class="generator-container">
            <button id="load-ai-generator" class="button">Open Generator</button>

            <div id="ai-generator-panel" style="display:none; margin-top:1.5rem;">
                
                <!-- Model Selection -->
                <div class="model-selector-group">
                    <label for="model-select" style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">
                        Choose AI Model:
                    </label>
                    <select id="model-select" class="model-select">
                        <option value="openai">OpenAI GPT-3.5</option>
                        <option value="deepseek">DeepSeek Chat</option>
                    </select>
                    <span id="current-model-badge" class="model-badge openai"></span>
                </div>

                <!-- Chat Interface -->
                <div class="ai-chat-container" style="margin-top: 1rem;">
                    <div id="chat-messages" class="chat-messages">
                        <div class="message ai-message">
                            <div class="message-content">
                                <div class="model-indicator"></div>
                                Hello! I'm your AI assistant. Choose a model above and start chatting!
                            </div>
                        </div>
                    </div>

                    <div class="input-area">
                        <textarea 
                            id="user-input" 
                            placeholder="Ask me anything or give me a creative prompt..." 
                            rows="3" 
                            class="input-field"
                            style="width: 100%; margin-bottom: 0.5rem;"
                        ></textarea>
                        <button id="generate-ai" class="button accent">Generate Text</button>
                    </div>
                </div>

                <p style="text-align: center; font-size: 0.7rem; color: #999; margin-top: 0.5rem;">
                    Powered by OpenAI & DeepSeek ‚Ä¢ No data retention ‚Ä¢ Rate limited for fair usage
                </p>
            </div>
        </div>
    </section>

    </main>

    <footer id="footcolor">
      <p>¬© 2025 Jason Yap ‚Äî This website is my personal project.</p>
      <p>
        <a href="mailto:jason-yap@outlook.com">Email</a> | 
        <a href="https://instagram.com/yappotamus" target="_blank">Instagram</a> | 
        <a href="https://github.com/just-anotherday" target="_blank">GitHub</a>
      </p>
    </footer>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script type="module" src="../js/main.js"></script>

  <!-- AI Generator Script -->
  <script>
  // AI Generator functionality
  document.addEventListener('DOMContentLoaded', function() {
    const loadGeneratorBtn = document.getElementById('load-ai-generator');
    const generatorPanel = document.getElementById('ai-generator-panel');
    const generateBtn = document.getElementById('generate-ai');
    const promptInput = document.getElementById('ai-prompt');
    const resultDiv = document.getElementById('ai-result');
    
  
    const BACKEND_URL = 'https://yappotamus.onrender.com/ai'; 
    
    let lastRequestTime = 0;
    const MIN_REQUEST_INTERVAL = 3000; // 3 seconds between requests

    // Toggle generator panel
    if (loadGeneratorBtn) {
      loadGeneratorBtn.addEventListener('click', function() {
        if (generatorPanel.style.display === 'none') {
          generatorPanel.style.display = 'block';
          loadGeneratorBtn.textContent = 'Close Generator';
        } else {
          generatorPanel.style.display = 'none';
          loadGeneratorBtn.textContent = 'Open Generator';
        }
      });
    }

    if (generateBtn) {
      generateBtn.addEventListener('click', generateAI);
    }

    // Add input validation and character counter
    promptInput.addEventListener('input', function() {
      if (this.value.length > 200) {
        this.value = this.value.substring(0, 200);
        showResult('Prompt limited to 200 characters', 'warning');
      }
      updateCharCounter();
    });

    // Add Enter key support
    promptInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        generateAI();
      }
    });

    function updateCharCounter() {
      let counter = document.getElementById('char-counter');
      if (!counter) {
        counter = document.createElement('div');
        counter.id = 'char-counter';
        counter.className = 'char-counter';
        promptInput.parentNode.appendChild(counter);
      }
      counter.textContent = `${promptInput.value.length}/200`;
    }

    async function generateAI() {
      const now = Date.now();
      if (now - lastRequestTime < MIN_REQUEST_INTERVAL) {
        showResult(`Please wait ${Math.ceil((MIN_REQUEST_INTERVAL - (now - lastRequestTime)) / 1000)} seconds before trying again.`, 'warning');
        return;
      }

      const prompt = promptInput.value.trim();
      
      if (!prompt) {
        showResult('Please enter a prompt.', 'error');
        return;
      }

      if (prompt.length < 3) {
        showResult('Prompt must be at least 3 characters long.', 'error');
        return;
      }

      // Show loading state
      generateBtn.disabled = true;
      generateBtn.textContent = 'Generating...';
      lastRequestTime = now;

      try {
        console.log('Sending request to backend...');
        
        const response = await fetch(BACKEND_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            prompt: prompt
          })
        });

        console.log('Response status:', response.status);
        
        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || `Server error: ${response.status}`);
        }

        showResult(data.result, 'success');

      } catch (error) {
        console.error('Full error details:', error);
        showResult(error.message, 'error');
      } finally {
        generateBtn.disabled = false;
        generateBtn.textContent = 'Generate Text';
      }
    }

    function showResult(message, type) {
      const colors = {
        error: '#dc3545',
        warning: '#ff9800', 
        success: '#333',
        loading: '#666'
      };
      
      const classes = {
        error: 'error',
        warning: 'warning',
        success: 'success',
        loading: 'loading'
      };
      
      resultDiv.innerHTML = `<p style="color: ${colors[type] || '#333'}">${message}</p>`;
      resultDiv.className = `ai-result-box ${classes[type] || ''}`;
      
      // Auto-clear warnings after 3 seconds
      if (type === 'warning') {
        setTimeout(() => {
          if (resultDiv.innerHTML.includes(message)) {
            resultDiv.innerHTML = '<p style="color:#666">Your AI-generated text will appear here.</p>';
            resultDiv.className = 'ai-result-box';
          }
        }, 3000);
      }
    }

    // Initialize character counter when panel opens
    loadGeneratorBtn.addEventListener('click', function() {
      if (generatorPanel.style.display === 'block') {
        setTimeout(updateCharCounter, 100);
      }
    });
  });
  </script>

</body>
</html>